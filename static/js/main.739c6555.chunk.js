(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){e.exports=a(61)},30:function(e,t,a){},58:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(16),s=a.n(l),i=(a(30),a(11)),r=a.n(i),d=a(17),c=a(18),u=a(19),p=a(22),h=a(20),y=a(6),m=a(23),g=a(21),f=a(7),v=a.n(f),w=(a(58),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).sdk=null,n.state={started:!1,received:"",receivedData:new Uint8Array([]),disabled:!0,decryptDisabled:!0,downloadDisabled:!0,message:"",sendButtonTxt:"SEND 1/1"},n.payloadChunks=[],n.payloadCount=0,n.payloadCountMax=1,n.shouldReset=!0,n.maxFileSize=5e3,n.handleFileSelect=n.handleFileSelect.bind(Object(y.a)(n)),n.handleMessageChange=n.handleMessageChange.bind(Object(y.a)(n)),n.downloadByteArray=n.downloadByteArray.bind(Object(y.a)(n)),n.concatTypedArray=a(59),n.audioError="Failed to open web audio stream.\n    This may happen if your browser doesn't support Web Audio or have a mic and speaker.",n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){"WebAssembly"in window||window.alert("WebAssembly is not supported in this browser")}},{key:"chunkArray",value:function(e,t){var a=0,n=e.length,o=[];for(a=0;a<n;a+=t){var l=e.slice(a,a+t);o.push(l)}return o}},{key:"collapse",value:function(){var e=document.getElementsByClassName("collapse-content")[0];e.style.maxHeight?e.style.maxHeight=null:e.style.maxHeight=e.scrollHeight+"px"}},{key:"checkIfHex",value:function(e){for(var t=/^[0-9a-fA-F]+$/,a=0;a<e.length;a++)if(!t.test(e.charAt(a)))return!1;return!0}},{key:"handleMessageChange",value:function(e){var t=document.getElementById("psw_input").value;(this.setState({message:e}),""!==t)&&(e=new v.a(t).encrypt(e));""!==e?this.setState({disabled:!1}):this.setState({disabled:!0}),this.payloadCountMax=Math.ceil(e.length/32),0===this.payloadCountMax&&(this.payloadCountMax=1),this.setState({sendButtonTxt:"SEND "+(this.payloadCount+1)+"/"+this.payloadCountMax})}},{key:"handleFileSelect",value:function(e){e.stopPropagation(),e.preventDefault();var t=this,a=e.dataTransfer.files,n=new FileReader;n.onload=function(e){var a=n.result;""!==a&&(t.setState({message:a,disabled:!1}),t.handleMessageChange(a))},a[0].size<=this.maxFileSize?n.readAsBinaryString(a[0]):alert("Max file size allowed: 5 KB")}},{key:"handleDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}},{key:"destroyClickedElement",value:function(e){document.body.removeChild(e.target)}},{key:"downloadByteArray",value:function(e,t){var a=t.join("").toUpperCase(),n=this.getMimetype(a),o=new Blob([t],{type:n}),l=document.createElement("a");l.download=e,l.innerHTML="Download File",null!=window.webkitURL?l.href=window.webkitURL.createObjectURL(o):(l.href=window.URL.createObjectURL(o),l.onclick=this.destroyClickedElement,l.style.display="none",document.body.appendChild(l)),l.click()}},{key:"getMimetype",value:function(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":return"image/jpeg";case"504B0304":return"application/zip";default:return"text/plain"}}},{key:"startSDK",value:function(){var e=Object(d.a)(r.a.mark(function e(){var t=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.Chirp)({key:"b2c2e7ed5Acebf8842C1f3F5F",onSending:function(e){console.log("Sending"),t.setState({disabled:!0,sendButtonTxt:"Sending..."})},onSent:function(e){console.log("Data sent"),t.payloadCount++,t.payloadCount>=t.payloadChunks.length&&(t.payloadCount=0),t.setState({disabled:!1,sendButtonTxt:"SEND "+(t.payloadCount+1)+"/"+t.payloadCountMax})},onReceiving:function(){console.log("Receiving..."),t.payloadCount=0,t.setState({disabled:!0,sendButtonTxt:"Incoming..."})},onReceived:function(e){if(console.log("Data received"),t.setState({sendButtonTxt:"SEND "+(t.payloadCount+1)+"/"+t.payloadCountMax}),e.length>0){var a;a=new TextDecoder("utf-8").decode(e),t.shouldReset&&(t.setState({received:"",receivedData:new Uint8Array([])}),t.shouldReset=!1),t.setState({receivedData:t.concatTypedArray(Uint8Array,t.state.receivedData,e),received:t.state.received+a,disabled:!1}),""!==document.getElementById("psw_input").value?t.setState({decryptDisabled:!1}):t.setState({decryptDisabled:!0}),t.setState({downloadDisabled:!1})}else t.setState({received:"Missed data. Try increase the volume.",disabled:!1}),t.shouldReset=!0}});case 2:this.sdk=e.sent,this.setState({started:!0});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"App"},o.a.createElement("header",null,o.a.createElement("h1",null,"Offline Audio Messenger")),this.state.started?o.a.createElement("div",null,o.a.createElement("button",{onClick:this.collapse,className:"IntroButton"},"HOW TO"),o.a.createElement("div",{className:"collapse-content"},o.a.createElement("strong",null,"No message data is shared but feel free to download site and use offline.",o.a.createElement("br",null)),o.a.createElement("ol",null,o.a.createElement("li",null,"Send message from one device to another using speaker and microphone."),o.a.createElement("li",null,"If they are far apart you can use a recorder for example a phone app."),o.a.createElement("li",null,"Use optional encryption to avoid anyone to intercept the audio."),o.a.createElement("li",null,"Each (non encrypted) part is 32 chars and split automatically."),o.a.createElement("li",null,"Use same encryption key on the receiving end.")),o.a.createElement("br",null)),o.a.createElement("div",{className:"MsgBoxContainer"},o.a.createElement("input",{className:"MsgBox",type:"text",id:"message_input",placeholder:"Enter message",value:this.state.message,onChange:function(t){e.handleMessageChange(t.target.value)}}),o.a.createElement("div",{id:"drop_zone",onDragOver:this.handleDragOver,onDrop:this.handleFileSelect},"...or drop a file here"),o.a.createElement("input",{className:"MsgBox",type:"text",id:"psw_input",placeholder:"Encryption key (optional)",onChange:function(t){var a=t.target.value,n=document.getElementById("resultTxt").value,o=document.getElementById("message_input").value;(""!==a&&""!==n?e.setState({decryptDisabled:!1}):e.setState({decryptDisabled:!0}),""!==a)&&(o=new v.a(a).encrypt(o));""!==o?(e.setState({disabled:!1}),e.payloadCountMax=Math.ceil(o.length/32),e.setState({sendButtonTxt:"SEND "+(e.payloadCount+1)+"/"+e.payloadCountMax})):e.setState({disabled:!0})}})),this.state.disabled?o.a.createElement("button",{id:"sendButton",className:"SendButton",disabled:!0},this.state.sendButtonTxt):o.a.createElement("button",{id:"sendButton",className:"SendButton",onClick:function(){if(0===e.payloadCount||e.payloadCount>=e.payloadChunks.length){var t=e.state.message,a=document.getElementById("psw_input").value,n=new Uint8Array(["Unknown"]);if(""!==a)t=new v.a(a).encrypt(t);n=new TextEncoder("utf-8").encode(t),e.payloadChunks=e.chunkArray(n,32),e.payloadCountMax=e.payloadChunks.length,e.sdk.send(e.payloadChunks[0])}else e.sdk.send(e.payloadChunks[e.payloadCount])}},this.state.sendButtonTxt),o.a.createElement("div",{className:"received-message"},o.a.createElement("textarea",{id:"resultTxt",className:"Result",rows:"10",value:this.state.received,placeholder:"Waiting on message...",readOnly:!0})),o.a.createElement("div",null,this.state.decryptDisabled?o.a.createElement("button",{id:"decryptButton",className:"DecryptButton",disabled:!0},"DECRYPT"):o.a.createElement("button",{id:"decryptButton",className:"DecryptButton",onClick:function(){var e=document.getElementById("resultTxt").value,t=document.getElementById("psw_input"),a=new v.a(t.value).decrypt(e);document.getElementById("resultTxt").value=a}},"DECRYPT"),o.a.createElement("button",{id:"resetButton",className:"ResetButton",onClick:function(){e.setState({received:"",receivedData:new Uint8Array([]),message:"",sendButtonTxt:"SEND 1/1",decryptDisabled:!0,downloadDisabled:!0}),e.payloadCount=0,e.payloadCountMax=1,e.payloadChunks=[]}},"RESET"),this.state.downloadDisabled?o.a.createElement("button",{id:"downloadButton",className:"DownloadButton",disabled:!0},"DOWNLOAD"):o.a.createElement("button",{id:"downloadButton",className:"DownloadButton",onClick:function(){e.downloadByteArray("test.txt",e.state.receivedData)}},"DOWNLOAD"))):o.a.createElement("button",{className:"StartButton",onClick:function(){e.startSDK()}},"START"),o.a.createElement("div",{className:"extra"}),o.a.createElement("footer",{className:"Footer"},o.a.createElement("span",null,"Offline version can be downloaded at "),o.a.createElement("a",{href:"https://github.com"},"Github")))}}]),t}(o.a.Component)),b=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(o.a.createElement(w,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");b?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):E(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):E(t,e)})}}()}},[[24,1,2]]]);
//# sourceMappingURL=main.739c6555.chunk.js.map